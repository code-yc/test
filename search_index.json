{"index":{"version":"0.5.12","fields":[{"name":"title","boost":10},{"name":"keywords","boost":15},{"name":"body","boost":1}],"ref":"url","documentStore":{"store":{"./":["introduct","介绍"],"Go 内存逃逸.html":["\"alice\"}","&i","(*int){","([]int){","(map[int]int){","*int,","//","0","1","1、go语言内存分配的基本原则","1、内存管理","1、案例：返回指针","2","2)","2:2}","2、原理","2、案例：向channel发送指针","3、案例：在slice或map中存储指针","3、逃逸的影响",":",":=","=","[]int{...}","[]int{1,2,3}","build","ch","createperson()","escap","f1()","f1(){","f2()","f3()","fmt.println(i)","fmt.println(result)","func","func()","gcflag","gcflags进行逃逸分析","go","heap","interface{}","list","list[0]","m","main()","main.go","make","make([]*int,2)","make(chan","map","map[int]int{1:1,","move","name","new","p","person","person{name:","result","return","s","slice","slice和map在底层实现上与指针相同","string","struct","type","{","}","一、什么是内存逃逸？","七、逃逸分析","三、内存逃逸：闭包","严格限制变量的作用域。如果一个变量只在函数内部使用，就不要将其返回或赋值给外部变量。","举例：函数内部定义一个过大的切片","举例：定义一个interface但未赋值、","举例：对切片进行扩展时，不知道切片的大小","二、内存逃逸：指针逃逸","五、内存逃逸：栈空间不足","你会观察到以下意味着发生了逃逸","使用","六、优化策略","内存占用增加","内存泄漏","内存逃逸","函数动态分配内存，需要gc释放。","占用空间过大，会逃逸到堆上","向channel中发送数据的指针或包含指针的值","四、内存逃逸：接口动态分配","因此，在运行时，将对象分配到堆上","在go语言中，内存分配有两种方式：栈分配和堆分配","在slice或map中存储指针或包含指针的值","在下例中，返回的函数用到了i，说明i超出f1()的生命周期","在函数内部创建的变量/对象，在函数结束后仍然被其他部分引用或持有","堆分配通过","如果一个函数返回一个闭包，并且该闭包引用了函数的局部变量，那么这些变量会逃逸到堆上。","定义：本应在栈上分配的内存被分配到堆上","当一个具体类型的变量被赋值给接口类型时，由于接口的动态特性，具体的值可能会发生逃逸。","当不必要的时候，尽量使用值传递而不是指针传递。","当函数的局部变量/对象，被函数外部所引用时，会逃逸到堆上","当带有指针的返回值，赋值给外部变量或作为参数传递给其他函数时","性能下降","或者","指向栈上对象的指针不能超过该栈对象的生命周期（如果栈对象被回收了，指针一定要被回收，如果不能，会挪到堆上）","指向栈上对象的指针，不能存储到堆上（如果指针存储到堆上，就会将对象也一起挪到堆上）","指针","是一个局部变量","是接口类型，内部包含","栈分配在函数调用时为局部变量分配内存，当函数返回时，这些内存会自动释放。","由于接口可以持有任意实现了该接口的类型，编译器在编译时无法确定具体的动态类型","的容量。","类型的值","编译器不知道该值什么时候会被接收，因此只能放入堆中","编译器无法确定该变量何时停止使用，因此必须将该数据分配到堆上，使其逃离当前函数作用域","编译器无法确定该指针引用的数据是否在函数返回后还会使用，因此将会将指针指向的值分配到堆上，以便函数返回后继续存在","编译时无法确定类型或大小，会逃逸到堆上","补充","被赋值给接口类型，发生了内存逃逸","这意味着即使函数返回后，这部分内存也不会被自动释放，需要等待垃圾回收器gc来回收。","避免在频繁调用的函数中使用闭包。","预分配切片和","，当其他协程或方法引用channel里的值时"]},"length":2},"tokenStore":{"root":{"0":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}},"1":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}},"、":{"docs":{},"g":{"docs":{},"o":{"docs":{},"语":{"docs":{},"言":{"docs":{},"内":{"docs":{},"存":{"docs":{},"分":{"docs":{},"配":{"docs":{},"的":{"docs":{},"基":{"docs":{},"本":{"docs":{},"原":{"docs":{},"则":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}},"内":{"docs":{},"存":{"docs":{},"管":{"docs":{},"理":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"案":{"docs":{},"例":{"docs":{},"：":{"docs":{},"返":{"docs":{},"回":{"docs":{},"指":{"docs":{},"针":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}},"2":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}},":":{"2":{"docs":{},"}":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"docs":{}},"、":{"docs":{},"原":{"docs":{},"理":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"案":{"docs":{},"例":{"docs":{},"：":{"docs":{},"向":{"docs":{},"c":{"docs":{},"h":{"docs":{},"a":{"docs":{},"n":{"docs":{},"n":{"docs":{},"e":{"docs":{},"l":{"docs":{},"发":{"docs":{},"送":{"docs":{},"指":{"docs":{},"针":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}},"3":{"docs":{},"、":{"docs":{},"案":{"docs":{},"例":{"docs":{},"：":{"docs":{},"在":{"docs":{},"s":{"docs":{},"l":{"docs":{},"i":{"docs":{},"c":{"docs":{},"e":{"docs":{},"或":{"docs":{},"m":{"docs":{},"a":{"docs":{},"p":{"docs":{},"中":{"docs":{},"存":{"docs":{},"储":{"docs":{},"指":{"docs":{},"针":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}},"逃":{"docs":{},"逸":{"docs":{},"的":{"docs":{},"影":{"docs":{},"响":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}},"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"r":{"docs":{},"o":{"docs":{},"d":{"docs":{},"u":{"docs":{},"c":{"docs":{},"t":{"docs":{"./":{"ref":"./","tf":1}}}}}}}},"e":{"docs":{},"r":{"docs":{},"f":{"docs":{},"a":{"docs":{},"c":{"docs":{},"e":{"docs":{},"{":{"docs":{},"}":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}},"介":{"docs":{},"绍":{"docs":{"./":{"ref":"./","tf":10}}}},"\"":{"docs":{},"a":{"docs":{},"l":{"docs":{},"i":{"docs":{},"c":{"docs":{},"e":{"docs":{},"\"":{"docs":{},"}":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}},"&":{"docs":{},"i":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}}}},"(":{"docs":{},"*":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},")":{"docs":{},"{":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}},"[":{"docs":{},"]":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},")":{"docs":{},"{":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}},"m":{"docs":{},"a":{"docs":{},"p":{"docs":{},"[":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"]":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},")":{"docs":{},"{":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}},"*":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},",":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}},"/":{"docs":{},"/":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.03488372093023256}}}},":":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}},"=":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.05813953488372093}}}},"=":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}},"[":{"docs":{},"]":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"{":{"1":{"docs":{},",":{"2":{"docs":{},",":{"3":{"docs":{},"}":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"docs":{}}},"docs":{}}},"docs":{},".":{"docs":{},".":{"docs":{},".":{"docs":{},"}":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}},"b":{"docs":{},"u":{"docs":{},"i":{"docs":{},"l":{"docs":{},"d":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}},"c":{"docs":{},"h":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}}},"r":{"docs":{},"e":{"docs":{},"a":{"docs":{},"t":{"docs":{},"e":{"docs":{},"p":{"docs":{},"e":{"docs":{},"r":{"docs":{},"s":{"docs":{},"o":{"docs":{},"n":{"docs":{},"(":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}}}}}}}}}}}}}}}},"e":{"docs":{},"s":{"docs":{},"c":{"docs":{},"a":{"docs":{},"p":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}},"f":{"1":{"docs":{},"(":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.01744186046511628}},"{":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"2":{"docs":{},"(":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}},"3":{"docs":{},"(":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}},"docs":{},"m":{"docs":{},"t":{"docs":{},".":{"docs":{},"p":{"docs":{},"r":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"l":{"docs":{},"n":{"docs":{},"(":{"docs":{},"i":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"r":{"docs":{},"e":{"docs":{},"s":{"docs":{},"u":{"docs":{},"l":{"docs":{},"t":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}},"u":{"docs":{},"n":{"docs":{},"c":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.046511627906976744}},"(":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}}}}}}}},"g":{"docs":{},"c":{"docs":{},"f":{"docs":{},"l":{"docs":{},"a":{"docs":{},"g":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}},"s":{"docs":{},"进":{"docs":{},"行":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"分":{"docs":{},"析":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}},"o":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":5.005813953488372}}}},"h":{"docs":{},"e":{"docs":{},"a":{"docs":{},"p":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}}}}}},"l":{"docs":{},"i":{"docs":{},"s":{"docs":{},"t":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}},"[":{"0":{"docs":{},"]":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"docs":{}}}}}},"m":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}},"a":{"docs":{},"i":{"docs":{},"n":{"docs":{},"(":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},".":{"docs":{},"g":{"docs":{},"o":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}},"k":{"docs":{},"e":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}},"(":{"docs":{},"[":{"docs":{},"]":{"docs":{},"*":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},",":{"2":{"docs":{},")":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"docs":{}}}}}}}},"c":{"docs":{},"h":{"docs":{},"a":{"docs":{},"n":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}},"p":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}},"[":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"]":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"{":{"1":{"docs":{},":":{"1":{"docs":{},",":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"docs":{}}},"docs":{}}}}}}}}}}}},"o":{"docs":{},"v":{"docs":{},"e":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"n":{"docs":{},"a":{"docs":{},"m":{"docs":{},"e":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}},"e":{"docs":{},"w":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}},"p":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.023255813953488372}},"e":{"docs":{},"r":{"docs":{},"s":{"docs":{},"o":{"docs":{},"n":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}},"{":{"docs":{},"n":{"docs":{},"a":{"docs":{},"m":{"docs":{},"e":{"docs":{},":":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}},"r":{"docs":{},"e":{"docs":{},"s":{"docs":{},"u":{"docs":{},"l":{"docs":{},"t":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}}}}}},"t":{"docs":{},"u":{"docs":{},"r":{"docs":{},"n":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.029069767441860465}}}}}}}},"s":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.011627906976744186}},"l":{"docs":{},"i":{"docs":{},"c":{"docs":{},"e":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}},"和":{"docs":{},"m":{"docs":{},"a":{"docs":{},"p":{"docs":{},"在":{"docs":{},"底":{"docs":{},"层":{"docs":{},"实":{"docs":{},"现":{"docs":{},"上":{"docs":{},"与":{"docs":{},"指":{"docs":{},"针":{"docs":{},"相":{"docs":{},"同":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}},"t":{"docs":{},"r":{"docs":{},"i":{"docs":{},"n":{"docs":{},"g":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}},"u":{"docs":{},"c":{"docs":{},"t":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}},"t":{"docs":{},"y":{"docs":{},"p":{"docs":{},"e":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"{":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.03488372093023256}}},"}":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.05232558139534884}}},"一":{"docs":{},"、":{"docs":{},"什":{"docs":{},"么":{"docs":{},"是":{"docs":{},"内":{"docs":{},"存":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"？":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}},"七":{"docs":{},"、":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"分":{"docs":{},"析":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}},"三":{"docs":{},"、":{"docs":{},"内":{"docs":{},"存":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"：":{"docs":{},"闭":{"docs":{},"包":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}},"严":{"docs":{},"格":{"docs":{},"限":{"docs":{},"制":{"docs":{},"变":{"docs":{},"量":{"docs":{},"的":{"docs":{},"作":{"docs":{},"用":{"docs":{},"域":{"docs":{},"。":{"docs":{},"如":{"docs":{},"果":{"docs":{},"一":{"docs":{},"个":{"docs":{},"变":{"docs":{},"量":{"docs":{},"只":{"docs":{},"在":{"docs":{},"函":{"docs":{},"数":{"docs":{},"内":{"docs":{},"部":{"docs":{},"使":{"docs":{},"用":{"docs":{},"，":{"docs":{},"就":{"docs":{},"不":{"docs":{},"要":{"docs":{},"将":{"docs":{},"其":{"docs":{},"返":{"docs":{},"回":{"docs":{},"或":{"docs":{},"赋":{"docs":{},"值":{"docs":{},"给":{"docs":{},"外":{"docs":{},"部":{"docs":{},"变":{"docs":{},"量":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"举":{"docs":{},"例":{"docs":{},"：":{"docs":{},"函":{"docs":{},"数":{"docs":{},"内":{"docs":{},"部":{"docs":{},"定":{"docs":{},"义":{"docs":{},"一":{"docs":{},"个":{"docs":{},"过":{"docs":{},"大":{"docs":{},"的":{"docs":{},"切":{"docs":{},"片":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}},"定":{"docs":{},"义":{"docs":{},"一":{"docs":{},"个":{"docs":{},"i":{"docs":{},"n":{"docs":{},"t":{"docs":{},"e":{"docs":{},"r":{"docs":{},"f":{"docs":{},"a":{"docs":{},"c":{"docs":{},"e":{"docs":{},"但":{"docs":{},"未":{"docs":{},"赋":{"docs":{},"值":{"docs":{},"、":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}},"对":{"docs":{},"切":{"docs":{},"片":{"docs":{},"进":{"docs":{},"行":{"docs":{},"扩":{"docs":{},"展":{"docs":{},"时":{"docs":{},"，":{"docs":{},"不":{"docs":{},"知":{"docs":{},"道":{"docs":{},"切":{"docs":{},"片":{"docs":{},"的":{"docs":{},"大":{"docs":{},"小":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}},"二":{"docs":{},"、":{"docs":{},"内":{"docs":{},"存":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"：":{"docs":{},"指":{"docs":{},"针":{"docs":{},"逃":{"docs":{},"逸":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}},"五":{"docs":{},"、":{"docs":{},"内":{"docs":{},"存":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"：":{"docs":{},"栈":{"docs":{},"空":{"docs":{},"间":{"docs":{},"不":{"docs":{},"足":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}},"你":{"docs":{},"会":{"docs":{},"观":{"docs":{},"察":{"docs":{},"到":{"docs":{},"以":{"docs":{},"下":{"docs":{},"意":{"docs":{},"味":{"docs":{},"着":{"docs":{},"发":{"docs":{},"生":{"docs":{},"了":{"docs":{},"逃":{"docs":{},"逸":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}},"使":{"docs":{},"用":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"六":{"docs":{},"、":{"docs":{},"优":{"docs":{},"化":{"docs":{},"策":{"docs":{},"略":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}},"内":{"docs":{},"存":{"docs":{},"占":{"docs":{},"用":{"docs":{},"增":{"docs":{},"加":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"泄":{"docs":{},"漏":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"逃":{"docs":{},"逸":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":5}}}}}},"函":{"docs":{},"数":{"docs":{},"动":{"docs":{},"态":{"docs":{},"分":{"docs":{},"配":{"docs":{},"内":{"docs":{},"存":{"docs":{},"，":{"docs":{},"需":{"docs":{},"要":{"docs":{},"g":{"docs":{},"c":{"docs":{},"释":{"docs":{},"放":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}},"占":{"docs":{},"用":{"docs":{},"空":{"docs":{},"间":{"docs":{},"过":{"docs":{},"大":{"docs":{},"，":{"docs":{},"会":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}},"向":{"docs":{},"c":{"docs":{},"h":{"docs":{},"a":{"docs":{},"n":{"docs":{},"n":{"docs":{},"e":{"docs":{},"l":{"docs":{},"中":{"docs":{},"发":{"docs":{},"送":{"docs":{},"数":{"docs":{},"据":{"docs":{},"的":{"docs":{},"指":{"docs":{},"针":{"docs":{},"或":{"docs":{},"包":{"docs":{},"含":{"docs":{},"指":{"docs":{},"针":{"docs":{},"的":{"docs":{},"值":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}},"四":{"docs":{},"、":{"docs":{},"内":{"docs":{},"存":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"：":{"docs":{},"接":{"docs":{},"口":{"docs":{},"动":{"docs":{},"态":{"docs":{},"分":{"docs":{},"配":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}},"因":{"docs":{},"此":{"docs":{},"，":{"docs":{},"在":{"docs":{},"运":{"docs":{},"行":{"docs":{},"时":{"docs":{},"，":{"docs":{},"将":{"docs":{},"对":{"docs":{},"象":{"docs":{},"分":{"docs":{},"配":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}},"在":{"docs":{},"g":{"docs":{},"o":{"docs":{},"语":{"docs":{},"言":{"docs":{},"中":{"docs":{},"，":{"docs":{},"内":{"docs":{},"存":{"docs":{},"分":{"docs":{},"配":{"docs":{},"有":{"docs":{},"两":{"docs":{},"种":{"docs":{},"方":{"docs":{},"式":{"docs":{},"：":{"docs":{},"栈":{"docs":{},"分":{"docs":{},"配":{"docs":{},"和":{"docs":{},"堆":{"docs":{},"分":{"docs":{},"配":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}},"s":{"docs":{},"l":{"docs":{},"i":{"docs":{},"c":{"docs":{},"e":{"docs":{},"或":{"docs":{},"m":{"docs":{},"a":{"docs":{},"p":{"docs":{},"中":{"docs":{},"存":{"docs":{},"储":{"docs":{},"指":{"docs":{},"针":{"docs":{},"或":{"docs":{},"包":{"docs":{},"含":{"docs":{},"指":{"docs":{},"针":{"docs":{},"的":{"docs":{},"值":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}},"下":{"docs":{},"例":{"docs":{},"中":{"docs":{},"，":{"docs":{},"返":{"docs":{},"回":{"docs":{},"的":{"docs":{},"函":{"docs":{},"数":{"docs":{},"用":{"docs":{},"到":{"docs":{},"了":{"docs":{},"i":{"docs":{},"，":{"docs":{},"说":{"docs":{},"明":{"docs":{},"i":{"docs":{},"超":{"docs":{},"出":{"docs":{},"f":{"1":{"docs":{},"(":{"docs":{},")":{"docs":{},"的":{"docs":{},"生":{"docs":{},"命":{"docs":{},"周":{"docs":{},"期":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}},"docs":{}}}}}}}}}}}}}}}}}}}}},"函":{"docs":{},"数":{"docs":{},"内":{"docs":{},"部":{"docs":{},"创":{"docs":{},"建":{"docs":{},"的":{"docs":{},"变":{"docs":{},"量":{"docs":{},"/":{"docs":{},"对":{"docs":{},"象":{"docs":{},"，":{"docs":{},"在":{"docs":{},"函":{"docs":{},"数":{"docs":{},"结":{"docs":{},"束":{"docs":{},"后":{"docs":{},"仍":{"docs":{},"然":{"docs":{},"被":{"docs":{},"其":{"docs":{},"他":{"docs":{},"部":{"docs":{},"分":{"docs":{},"引":{"docs":{},"用":{"docs":{},"或":{"docs":{},"持":{"docs":{},"有":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"堆":{"docs":{},"分":{"docs":{},"配":{"docs":{},"通":{"docs":{},"过":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}},"如":{"docs":{},"果":{"docs":{},"一":{"docs":{},"个":{"docs":{},"函":{"docs":{},"数":{"docs":{},"返":{"docs":{},"回":{"docs":{},"一":{"docs":{},"个":{"docs":{},"闭":{"docs":{},"包":{"docs":{},"，":{"docs":{},"并":{"docs":{},"且":{"docs":{},"该":{"docs":{},"闭":{"docs":{},"包":{"docs":{},"引":{"docs":{},"用":{"docs":{},"了":{"docs":{},"函":{"docs":{},"数":{"docs":{},"的":{"docs":{},"局":{"docs":{},"部":{"docs":{},"变":{"docs":{},"量":{"docs":{},"，":{"docs":{},"那":{"docs":{},"么":{"docs":{},"这":{"docs":{},"些":{"docs":{},"变":{"docs":{},"量":{"docs":{},"会":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"定":{"docs":{},"义":{"docs":{},"：":{"docs":{},"本":{"docs":{},"应":{"docs":{},"在":{"docs":{},"栈":{"docs":{},"上":{"docs":{},"分":{"docs":{},"配":{"docs":{},"的":{"docs":{},"内":{"docs":{},"存":{"docs":{},"被":{"docs":{},"分":{"docs":{},"配":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}},"当":{"docs":{},"一":{"docs":{},"个":{"docs":{},"具":{"docs":{},"体":{"docs":{},"类":{"docs":{},"型":{"docs":{},"的":{"docs":{},"变":{"docs":{},"量":{"docs":{},"被":{"docs":{},"赋":{"docs":{},"值":{"docs":{},"给":{"docs":{},"接":{"docs":{},"口":{"docs":{},"类":{"docs":{},"型":{"docs":{},"时":{"docs":{},"，":{"docs":{},"由":{"docs":{},"于":{"docs":{},"接":{"docs":{},"口":{"docs":{},"的":{"docs":{},"动":{"docs":{},"态":{"docs":{},"特":{"docs":{},"性":{"docs":{},"，":{"docs":{},"具":{"docs":{},"体":{"docs":{},"的":{"docs":{},"值":{"docs":{},"可":{"docs":{},"能":{"docs":{},"会":{"docs":{},"发":{"docs":{},"生":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"不":{"docs":{},"必":{"docs":{},"要":{"docs":{},"的":{"docs":{},"时":{"docs":{},"候":{"docs":{},"，":{"docs":{},"尽":{"docs":{},"量":{"docs":{},"使":{"docs":{},"用":{"docs":{},"值":{"docs":{},"传":{"docs":{},"递":{"docs":{},"而":{"docs":{},"不":{"docs":{},"是":{"docs":{},"指":{"docs":{},"针":{"docs":{},"传":{"docs":{},"递":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}},"函":{"docs":{},"数":{"docs":{},"的":{"docs":{},"局":{"docs":{},"部":{"docs":{},"变":{"docs":{},"量":{"docs":{},"/":{"docs":{},"对":{"docs":{},"象":{"docs":{},"，":{"docs":{},"被":{"docs":{},"函":{"docs":{},"数":{"docs":{},"外":{"docs":{},"部":{"docs":{},"所":{"docs":{},"引":{"docs":{},"用":{"docs":{},"时":{"docs":{},"，":{"docs":{},"会":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"带":{"docs":{},"有":{"docs":{},"指":{"docs":{},"针":{"docs":{},"的":{"docs":{},"返":{"docs":{},"回":{"docs":{},"值":{"docs":{},"，":{"docs":{},"赋":{"docs":{},"值":{"docs":{},"给":{"docs":{},"外":{"docs":{},"部":{"docs":{},"变":{"docs":{},"量":{"docs":{},"或":{"docs":{},"作":{"docs":{},"为":{"docs":{},"参":{"docs":{},"数":{"docs":{},"传":{"docs":{},"递":{"docs":{},"给":{"docs":{},"其":{"docs":{},"他":{"docs":{},"函":{"docs":{},"数":{"docs":{},"时":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"性":{"docs":{},"能":{"docs":{},"下":{"docs":{},"降":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"或":{"docs":{},"者":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"指":{"docs":{},"向":{"docs":{},"栈":{"docs":{},"上":{"docs":{},"对":{"docs":{},"象":{"docs":{},"的":{"docs":{},"指":{"docs":{},"针":{"docs":{},"不":{"docs":{},"能":{"docs":{},"超":{"docs":{},"过":{"docs":{},"该":{"docs":{},"栈":{"docs":{},"对":{"docs":{},"象":{"docs":{},"的":{"docs":{},"生":{"docs":{},"命":{"docs":{},"周":{"docs":{},"期":{"docs":{},"（":{"docs":{},"如":{"docs":{},"果":{"docs":{},"栈":{"docs":{},"对":{"docs":{},"象":{"docs":{},"被":{"docs":{},"回":{"docs":{},"收":{"docs":{},"了":{"docs":{},"，":{"docs":{},"指":{"docs":{},"针":{"docs":{},"一":{"docs":{},"定":{"docs":{},"要":{"docs":{},"被":{"docs":{},"回":{"docs":{},"收":{"docs":{},"，":{"docs":{},"如":{"docs":{},"果":{"docs":{},"不":{"docs":{},"能":{"docs":{},"，":{"docs":{},"会":{"docs":{},"挪":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"）":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"，":{"docs":{},"不":{"docs":{},"能":{"docs":{},"存":{"docs":{},"储":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"（":{"docs":{},"如":{"docs":{},"果":{"docs":{},"指":{"docs":{},"针":{"docs":{},"存":{"docs":{},"储":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"，":{"docs":{},"就":{"docs":{},"会":{"docs":{},"将":{"docs":{},"对":{"docs":{},"象":{"docs":{},"也":{"docs":{},"一":{"docs":{},"起":{"docs":{},"挪":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"）":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"针":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"是":{"docs":{},"一":{"docs":{},"个":{"docs":{},"局":{"docs":{},"部":{"docs":{},"变":{"docs":{},"量":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}},"接":{"docs":{},"口":{"docs":{},"类":{"docs":{},"型":{"docs":{},"，":{"docs":{},"内":{"docs":{},"部":{"docs":{},"包":{"docs":{},"含":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}},"栈":{"docs":{},"分":{"docs":{},"配":{"docs":{},"在":{"docs":{},"函":{"docs":{},"数":{"docs":{},"调":{"docs":{},"用":{"docs":{},"时":{"docs":{},"为":{"docs":{},"局":{"docs":{},"部":{"docs":{},"变":{"docs":{},"量":{"docs":{},"分":{"docs":{},"配":{"docs":{},"内":{"docs":{},"存":{"docs":{},"，":{"docs":{},"当":{"docs":{},"函":{"docs":{},"数":{"docs":{},"返":{"docs":{},"回":{"docs":{},"时":{"docs":{},"，":{"docs":{},"这":{"docs":{},"些":{"docs":{},"内":{"docs":{},"存":{"docs":{},"会":{"docs":{},"自":{"docs":{},"动":{"docs":{},"释":{"docs":{},"放":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"由":{"docs":{},"于":{"docs":{},"接":{"docs":{},"口":{"docs":{},"可":{"docs":{},"以":{"docs":{},"持":{"docs":{},"有":{"docs":{},"任":{"docs":{},"意":{"docs":{},"实":{"docs":{},"现":{"docs":{},"了":{"docs":{},"该":{"docs":{},"接":{"docs":{},"口":{"docs":{},"的":{"docs":{},"类":{"docs":{},"型":{"docs":{},"，":{"docs":{},"编":{"docs":{},"译":{"docs":{},"器":{"docs":{},"在":{"docs":{},"编":{"docs":{},"译":{"docs":{},"时":{"docs":{},"无":{"docs":{},"法":{"docs":{},"确":{"docs":{},"定":{"docs":{},"具":{"docs":{},"体":{"docs":{},"的":{"docs":{},"动":{"docs":{},"态":{"docs":{},"类":{"docs":{},"型":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"的":{"docs":{},"容":{"docs":{},"量":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"类":{"docs":{},"型":{"docs":{},"的":{"docs":{},"值":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}},"编":{"docs":{},"译":{"docs":{},"器":{"docs":{},"不":{"docs":{},"知":{"docs":{},"道":{"docs":{},"该":{"docs":{},"值":{"docs":{},"什":{"docs":{},"么":{"docs":{},"时":{"docs":{},"候":{"docs":{},"会":{"docs":{},"被":{"docs":{},"接":{"docs":{},"收":{"docs":{},"，":{"docs":{},"因":{"docs":{},"此":{"docs":{},"只":{"docs":{},"能":{"docs":{},"放":{"docs":{},"入":{"docs":{},"堆":{"docs":{},"中":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}},"无":{"docs":{},"法":{"docs":{},"确":{"docs":{},"定":{"docs":{},"该":{"docs":{},"变":{"docs":{},"量":{"docs":{},"何":{"docs":{},"时":{"docs":{},"停":{"docs":{},"止":{"docs":{},"使":{"docs":{},"用":{"docs":{},"，":{"docs":{},"因":{"docs":{},"此":{"docs":{},"必":{"docs":{},"须":{"docs":{},"将":{"docs":{},"该":{"docs":{},"数":{"docs":{},"据":{"docs":{},"分":{"docs":{},"配":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"，":{"docs":{},"使":{"docs":{},"其":{"docs":{},"逃":{"docs":{},"离":{"docs":{},"当":{"docs":{},"前":{"docs":{},"函":{"docs":{},"数":{"docs":{},"作":{"docs":{},"用":{"docs":{},"域":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"指":{"docs":{},"针":{"docs":{},"引":{"docs":{},"用":{"docs":{},"的":{"docs":{},"数":{"docs":{},"据":{"docs":{},"是":{"docs":{},"否":{"docs":{},"在":{"docs":{},"函":{"docs":{},"数":{"docs":{},"返":{"docs":{},"回":{"docs":{},"后":{"docs":{},"还":{"docs":{},"会":{"docs":{},"使":{"docs":{},"用":{"docs":{},"，":{"docs":{},"因":{"docs":{},"此":{"docs":{},"将":{"docs":{},"会":{"docs":{},"将":{"docs":{},"指":{"docs":{},"针":{"docs":{},"指":{"docs":{},"向":{"docs":{},"的":{"docs":{},"值":{"docs":{},"分":{"docs":{},"配":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{},"，":{"docs":{},"以":{"docs":{},"便":{"docs":{},"函":{"docs":{},"数":{"docs":{},"返":{"docs":{},"回":{"docs":{},"后":{"docs":{},"继":{"docs":{},"续":{"docs":{},"存":{"docs":{},"在":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"时":{"docs":{},"无":{"docs":{},"法":{"docs":{},"确":{"docs":{},"定":{"docs":{},"类":{"docs":{},"型":{"docs":{},"或":{"docs":{},"大":{"docs":{},"小":{"docs":{},"，":{"docs":{},"会":{"docs":{},"逃":{"docs":{},"逸":{"docs":{},"到":{"docs":{},"堆":{"docs":{},"上":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}},"补":{"docs":{},"充":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}},"被":{"docs":{},"赋":{"docs":{},"值":{"docs":{},"给":{"docs":{},"接":{"docs":{},"口":{"docs":{},"类":{"docs":{},"型":{"docs":{},"，":{"docs":{},"发":{"docs":{},"生":{"docs":{},"了":{"docs":{},"内":{"docs":{},"存":{"docs":{},"逃":{"docs":{},"逸":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}},"这":{"docs":{},"意":{"docs":{},"味":{"docs":{},"着":{"docs":{},"即":{"docs":{},"使":{"docs":{},"函":{"docs":{},"数":{"docs":{},"返":{"docs":{},"回":{"docs":{},"后":{"docs":{},"，":{"docs":{},"这":{"docs":{},"部":{"docs":{},"分":{"docs":{},"内":{"docs":{},"存":{"docs":{},"也":{"docs":{},"不":{"docs":{},"会":{"docs":{},"被":{"docs":{},"自":{"docs":{},"动":{"docs":{},"释":{"docs":{},"放":{"docs":{},"，":{"docs":{},"需":{"docs":{},"要":{"docs":{},"等":{"docs":{},"待":{"docs":{},"垃":{"docs":{},"圾":{"docs":{},"回":{"docs":{},"收":{"docs":{},"器":{"docs":{},"g":{"docs":{},"c":{"docs":{},"来":{"docs":{},"回":{"docs":{},"收":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"避":{"docs":{},"免":{"docs":{},"在":{"docs":{},"频":{"docs":{},"繁":{"docs":{},"调":{"docs":{},"用":{"docs":{},"的":{"docs":{},"函":{"docs":{},"数":{"docs":{},"中":{"docs":{},"使":{"docs":{},"用":{"docs":{},"闭":{"docs":{},"包":{"docs":{},"。":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}},"预":{"docs":{},"分":{"docs":{},"配":{"docs":{},"切":{"docs":{},"片":{"docs":{},"和":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}},"，":{"docs":{},"当":{"docs":{},"其":{"docs":{},"他":{"docs":{},"协":{"docs":{},"程":{"docs":{},"或":{"docs":{},"方":{"docs":{},"法":{"docs":{},"引":{"docs":{},"用":{"docs":{},"c":{"docs":{},"h":{"docs":{},"a":{"docs":{},"n":{"docs":{},"n":{"docs":{},"e":{"docs":{},"l":{"docs":{},"里":{"docs":{},"的":{"docs":{},"值":{"docs":{},"时":{"docs":{"Go 内存逃逸.html":{"ref":"Go 内存逃逸.html","tf":0.005813953488372093}}}}}}}}}}}}}}}}}}}}}}}}},"length":121},"corpusTokens":["\"alice\"}","&i","(*int){","([]int){","(map[int]int){","*int,","//","0","1","1、go语言内存分配的基本原则","1、内存管理","1、案例：返回指针","2","2)","2:2}","2、原理","2、案例：向channel发送指针","3、案例：在slice或map中存储指针","3、逃逸的影响",":",":=","=","[]int{...}","[]int{1,2,3}","build","ch","createperson()","escap","f1()","f1(){","f2()","f3()","fmt.println(i)","fmt.println(result)","func","func()","gcflag","gcflags进行逃逸分析","go","heap","interface{}","introduct","list","list[0]","m","main()","main.go","make","make([]*int,2)","make(chan","map","map[int]int{1:1,","move","name","new","p","person","person{name:","result","return","s","slice","slice和map在底层实现上与指针相同","string","struct","type","{","}","一、什么是内存逃逸？","七、逃逸分析","三、内存逃逸：闭包","严格限制变量的作用域。如果一个变量只在函数内部使用，就不要将其返回或赋值给外部变量。","举例：函数内部定义一个过大的切片","举例：定义一个interface但未赋值、","举例：对切片进行扩展时，不知道切片的大小","二、内存逃逸：指针逃逸","五、内存逃逸：栈空间不足","介绍","你会观察到以下意味着发生了逃逸","使用","六、优化策略","内存占用增加","内存泄漏","内存逃逸","函数动态分配内存，需要gc释放。","占用空间过大，会逃逸到堆上","向channel中发送数据的指针或包含指针的值","四、内存逃逸：接口动态分配","因此，在运行时，将对象分配到堆上","在go语言中，内存分配有两种方式：栈分配和堆分配","在slice或map中存储指针或包含指针的值","在下例中，返回的函数用到了i，说明i超出f1()的生命周期","在函数内部创建的变量/对象，在函数结束后仍然被其他部分引用或持有","堆分配通过","如果一个函数返回一个闭包，并且该闭包引用了函数的局部变量，那么这些变量会逃逸到堆上。","定义：本应在栈上分配的内存被分配到堆上","当一个具体类型的变量被赋值给接口类型时，由于接口的动态特性，具体的值可能会发生逃逸。","当不必要的时候，尽量使用值传递而不是指针传递。","当函数的局部变量/对象，被函数外部所引用时，会逃逸到堆上","当带有指针的返回值，赋值给外部变量或作为参数传递给其他函数时","性能下降","或者","指向栈上对象的指针不能超过该栈对象的生命周期（如果栈对象被回收了，指针一定要被回收，如果不能，会挪到堆上）","指向栈上对象的指针，不能存储到堆上（如果指针存储到堆上，就会将对象也一起挪到堆上）","指针","是一个局部变量","是接口类型，内部包含","栈分配在函数调用时为局部变量分配内存，当函数返回时，这些内存会自动释放。","由于接口可以持有任意实现了该接口的类型，编译器在编译时无法确定具体的动态类型","的容量。","类型的值","编译器不知道该值什么时候会被接收，因此只能放入堆中","编译器无法确定该变量何时停止使用，因此必须将该数据分配到堆上，使其逃离当前函数作用域","编译器无法确定该指针引用的数据是否在函数返回后还会使用，因此将会将指针指向的值分配到堆上，以便函数返回后继续存在","编译时无法确定类型或大小，会逃逸到堆上","补充","被赋值给接口类型，发生了内存逃逸","这意味着即使函数返回后，这部分内存也不会被自动释放，需要等待垃圾回收器gc来回收。","避免在频繁调用的函数中使用闭包。","预分配切片和","，当其他协程或方法引用channel里的值时"],"pipeline":["stopWordFilter","stemmer"]},"store":{"./":{"url":"./","title":"介绍","keywords":"","body":"Introduction\n"},"Go 内存逃逸.html":{"url":"Go 内存逃逸.html","title":"Go 内存逃逸","keywords":"","body":"一、什么是内存逃逸？\n1、内存管理\n在Go语言中，内存分配有两种方式：栈分配和堆分配\n\n栈分配在函数调用时为局部变量分配内存，当函数返回时，这些内存会自动释放。\n堆分配通过 new 或者 make 函数动态分配内存，需要GC释放。\n\n2、原理\n\n定义：本应在栈上分配的内存被分配到堆上\n\n\n在函数内部创建的变量/对象，在函数结束后仍然被其他部分引用或持有\n这意味着即使函数返回后，这部分内存也不会被自动释放，需要等待垃圾回收器GC来回收。\n\n3、逃逸的影响\n\n内存占用增加\n性能下降\n内存泄漏\n\n二、内存逃逸：指针逃逸\n\n当函数的局部变量/对象，被函数外部所引用时，会逃逸到堆上\n\n1、案例：返回指针\n\n当带有指针的返回值，赋值给外部变量或作为参数传递给其他函数时\n编译器无法确定该变量何时停止使用，因此必须将该数据分配到堆上，使其逃离当前函数作用域\nslice和map在底层实现上与指针相同\n\n// 指针\nfunc f1() (*int){    \n    i := 0\n    return &i\n}\n\n// slice\nfunc f2() ([]int){    \n    s := []int{1,2,3}\n    return s\n}\n\n// map\nfunc f3() (map[int]int){    \n    m := map[int]int{1:1, 2:2}\n    return m\n}\n2、案例：向channel发送指针\n\n向channel中发送数据的指针或包含指针的值 ，当其他协程或方法引用channel里的值时\n编译器不知道该值什么时候会被接收，因此只能放入堆中\n\nfunc f1(){\n    i := 2\n    ch := make(chan *int, 2)\n    ch 3、案例：在slice或map中存储指针\n\n在slice或map中存储指针或包含指针的值\n编译器无法确定该指针引用的数据是否在函数返回后还会使用，因此将会将指针指向的值分配到堆上，以便函数返回后继续存在\n\nfunc f1() {\n    i := 1\n    list := make([]*int,2)\n    list[0] = &i\n}\n三、内存逃逸：闭包\n\n如果一个函数返回一个闭包，并且该闭包引用了函数的局部变量，那么这些变量会逃逸到堆上。\n\n\n在下例中，返回的函数用到了i，说明i超出f1()的生命周期\n\nfunc f1() func() {\n    i := 1\n    return func() {\n        fmt.Println(i)\n    }\n}\n四、内存逃逸：接口动态分配\n\n当一个具体类型的变量被赋值给接口类型时，由于接口的动态特性，具体的值可能会发生逃逸。\n\n\n由于接口可以持有任意实现了该接口的类型，编译器在编译时无法确定具体的动态类型\n因此，在运行时，将对象分配到堆上\n\ntype Person struct {\n    Name string\n}\n\nfunc createPerson() interface{} {\n    p := Person{Name: \"Alice\"}  // p 是一个局部变量\n    return p  // p 被赋值给接口类型，发生了内存逃逸\n}\n\nfunc main() {\n    result := createPerson()  // result 是接口类型，内部包含 Person 类型的值\n    fmt.Println(result)\n}\n五、内存逃逸：栈空间不足\n\n编译时无法确定类型或大小，会逃逸到堆上\n\n\n举例：定义一个interface但未赋值、\n举例：对切片进行扩展时，不知道切片的大小\n\n\n占用空间过大，会逃逸到堆上\n\n\n举例：函数内部定义一个过大的切片\n\n六、优化策略\n\n当不必要的时候，尽量使用值传递而不是指针传递。\n严格限制变量的作用域。如果一个变量只在函数内部使用，就不要将其返回或赋值给外部变量。\n避免在频繁调用的函数中使用闭包。\n预分配切片和 map 的容量。\n\n七、逃逸分析\n使用-gcflags进行逃逸分析\ngo build -gcflags main.go\n你会观察到以下意味着发生了逃逸\nmove to heap : i\n[]int{...} escapes to heap\n补充\n1、go语言内存分配的基本原则\n\n指向栈上对象的指针，不能存储到堆上（如果指针存储到堆上，就会将对象也一起挪到堆上）\n指向栈上对象的指针不能超过该栈对象的生命周期（如果栈对象被回收了，指针一定要被回收，如果不能，会挪到堆上）\n\n"}}}